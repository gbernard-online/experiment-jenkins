node {
    stage('clean') {
        cleanWs()
        sh 'docker container ls --filter=name=alpine --quiet | xargs --no-run-if-empty docker rm --force'
    }
    stage('clone') {
        checkout scm
    }
    stage('build') {
        sh 'docker buildx build --tag=alpine-gcc .'
    }
    stage('test') {
        docker.image('alpine-gcc').withRun('--name=alpine', 'yes') { c ->
            sh 'docker exec alpine hostname'
            sh 'ls'
            sh 'pwd'
        }
    }
}
